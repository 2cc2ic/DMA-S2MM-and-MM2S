# DMA-S2MM-and-MM2S

Build an open-source, extremely simple AXI DMA.

***
[TOC]

***

## 一、设计概述

### 1.1 设计目的

​	本项目构建了一个开源、极简的`AXI DMA IP`，来帮助ZYNQ实际开发中更简单易行地完成大规模数据搬运。

### 1.2 基本功能

​	该IP核，支持传输任意长度32位数据 **(最大为`2^24-1`个)**，通过状态机控制，读写通道突发传输主要使用的突发长度为 16 ,其余分别使用突发长度为 8、4、2、1 进行补全。

![ip](./Picture/ip.JPG)

***
## 二、系统组成

### 2.1 整体介绍

#### 2.1.1 系统架构

![ip结构](./Picture/架构设计.jpg)

数据传输流程：

​	外部通过AXI4-lite接口写入IP内部的控制寄存器，启动对应通道的状态机完成相应的连续读写操作。读写通道均包含一个同步FIFO用于数据缓冲，从而实现AXI4与Stream数据之间的转换。

#### 2.1.2 代码结构

​	结构组成如下：



#### 2.1.3 接口介绍

1. 顶层
2. full_s2mm
3. stream_s2mm
4. full_mm2s
5. stream_mm2s
6. fifo

### 2.2 详细介绍

#### 2.2.1 控制寄存器



#### 2.2.2 AXI4接口



#### 2.2.3 AXIS接口

***
## 三、性能参数
### 3.1 时序分析



### 3.2 资源消耗



## 四、功能验证

共建立以下工程完成验证。

### 4.1 环路仿真

DMA_simulation

​	利用`AXI VIP`作为AXI4从机存储数据,通过`vivado`生成的`AXI4-full-master`例程写入初始化数据.同时也生成了`AXI4-lite-master`例程修改部分代码用于配置DMA内部控制寄存器,diagram中进行两次例化,一次用于配置读通道,一次用于配置写通道.然后调用`AXI4-Stream Data FIFO`IP用于验证读写通道时候的缓存.

​	结构示意图如下:

![imulation结构](./Picture/simulation.jpg)

### 4.2 开发板环路验证

​	在型号为`xc7z010clg400-1`的米联客`MZ701Amini`开发板完成实际验证.

​	结构示意图如下:

![simulation结构](./Picture/test.jpg)

### 4.3 摄像头采集系统



## 五、总结与拓展

### 5.1 历程总结



### 5.2 拓展之处 



#### 5.2.1 纯逻辑控制



#### 5.2.2 视频帧管理



## 六、参考文献